<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Solo per Daria</title>

<style>
:root{
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
  --safe-right: env(safe-area-inset-right);
}

*{ box-sizing:border-box; }
html, body { height:100%; }

body{
  margin:0;
  overflow:hidden;
  position:relative;
  color:#fff;
  font-family:-apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text",
              "Segoe UI", Roboto, Arial, sans-serif;

  background:url("sfondo.png") center/cover no-repeat;
  background-color:#000;
}

/* Overlay leggero */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background: rgba(0,0,0,0.12);
  z-index:1;
}

/* ====== VIDEO CAROUSEL ====== */
.bg-carousel{
  position:fixed;
  inset:0;
  z-index:0;
  display:none;
  background:#000;
}
.bg-carousel .layer{
  position:absolute;
  inset:0;
}

.bg-carousel video.bg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  filter: blur(18px) brightness(0.78);
  transform: scale(1.08);
  opacity:0;
  transition: opacity 1.2s ease;
}

.bg-carousel video.fg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:contain;
  opacity:0;
  transition: opacity 1.2s ease;
}

.bg-carousel video.active{ opacity:1; }

/* ====== CONTENUTI ====== */
.screen{
  position:relative;
  z-index:2;
  min-height:100dvh;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  padding:
    calc(20px + var(--safe-top))
    calc(18px + var(--safe-right))
    calc(22px + var(--safe-bottom))
    calc(18px + var(--safe-left));
  gap:26px;
  text-align:center;
}

.title{
  margin:0;
  width:92vw;
  max-width:780px;
  font-weight:900;
  letter-spacing:0.10em;
  text-transform:uppercase;
  font-size:clamp(24px, 6vw, 44px);
  line-height:1.18;
  text-shadow:
    0 3px 10px rgba(0,0,0,0.60),
    0 10px 28px rgba(0,0,0,0.55),
    0 0 32px rgba(0,0,0,0.35);
}

.buttons{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  justify-content:center;
}

button{
  padding:16px 26px;
  font-size:18px;
  border:none;
  border-radius:999px;
  cursor:pointer;
  min-width:130px;
  font-weight:900;
  text-transform:uppercase;
  letter-spacing:0.08em;
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
  backdrop-filter: blur(10px);
}

.yes-button{
  background:#ff0055;
  color:#fff;
  box-shadow:0 0 24px rgba(255,0,85,.70);
  transition: transform .25s ease, box-shadow .25s ease, font-size .25s ease;
}

.no-button{
  background:rgba(255,255,255,.14);
  color:#fff;
  border:1px solid rgba(255,255,255,.18);
}

/* Messaggio finale */
#finalMessage{ display:none; }

.finalText{
  width:92vw;
  max-width:820px;
  font-size:clamp(18px, 4.8vw, 30px);
  line-height:1.65;
  font-weight:900;
  letter-spacing:0.06em;
  text-transform:uppercase;
  text-shadow:
    0 3px 10px rgba(0,0,0,0.62),
    0 12px 30px rgba(0,0,0,0.55),
    0 0 34px rgba(0,0,0,0.35);
  animation: fadeIn 1.1s ease forwards;
  opacity:0;
}

@keyframes fadeIn{
  from{opacity:0; transform: translateY(10px) scale(0.99);}
  to{opacity:1; transform: translateY(0) scale(1);}
}

/* Cuori */
.heart{
  position:fixed;
  top:-12vh;
  z-index:3;
  pointer-events:none;
  will-change: transform;
  color:#ff4d88;
  text-shadow: 0 6px 18px rgba(0,0,0,.35);
  animation: fall linear infinite;
}
@keyframes fall{
  0%{ transform: translateY(-10vh); }
  100%{ transform: translateY(120vh); }
}
</style>
</head>

<body>

<!-- VIDEO CAROUSEL -->
<div class="bg-carousel" id="bgCarousel">
  <div class="layer" id="layerA">
    <video id="bgA" class="bg" muted loop playsinline autoplay preload="auto"></video>
    <video id="fgA" class="fg" muted loop playsinline autoplay preload="auto"></video>
  </div>
  <div class="layer" id="layerB">
    <video id="bgB" class="bg" muted loop playsinline autoplay preload="auto"></video>
    <video id="fgB" class="fg" muted loop playsinline autoplay preload="auto"></video>
  </div>
</div>

<!-- INIZIO -->
<div class="screen" id="main">
  <h2 class="title">POSSO AVERE IL PRIVILEGIO DI CHIAMARTI AMORE MIO? ðŸ¥ºðŸ’ž</h2>

  <div class="buttons">
    <button class="yes-button" onclick="handleYesClick()">SÃŒ</button>
    <button class="no-button" onclick="handleNoClick()">NO</button>
  </div>
</div>

<!-- FINALE -->
<div class="screen" id="finalMessage">
  <div class="finalText">
    âœ¨ DARIAâ€¦<br><br>
    PER ME SEI SPECIALE.<br>
    IL TUO NOME NON Ãˆ SOLO UN SUONOâ€¦<br>
    Ãˆ QUALCOSA CHE SENTO DENTRO.<br><br>
    Ãˆ CASA. Ãˆ BATTITO. Ãˆ LUCE.<br><br>
    MI FAI EMOZIONARE.<br>
    MI REGALI SORRISI IMPROVVISI<br>
    E UN AMORE CHE CRESCE OGNI GIORNO.<br><br>
    PERCHÃ‰ SCEGLIERTIâ€¦<br>
    Ãˆ LA COSA PIÃ™ BELLA CHE POTESSI FARE.<br><br>
    E QUESTO, DARIAâ€¦<br>
    Ãˆ LA COSA PIÃ™ NATURALE PER ME.
  </div>
</div>

<!-- MUSICA -->
<audio id="bgMusic" preload="auto" loop>
  <source src="musica.mp3" type="audio/mpeg">
</audio>

<script>
/* ====== CONFIG ====== */
const videos = ["video2.mp4","video3.mp4","video4.mp4"]; // metti i nomi ESATTI dei tuoi file
const MUSIC_START_AT = 44;
const SWITCH_EVERY_MS = 10000;

/* ====== VIDEO ELEMENTS ====== */
const bgA = document.getElementById("bgA");
const fgA = document.getElementById("fgA");
const bgB = document.getElementById("bgB");
const fgB = document.getElementById("fgB");

let active = { bg: bgA, fg: fgA };
let idle   = { bg: bgB, fg: fgB };
let index = 0;
let timer = null;

function forcePlay(v){
  v.muted = true;
  v.playsInline = true;
  const p = v.play();
  if (p && p.catch) p.catch(()=>{});
}

function setPair(pair, src){
  pair.bg.src = src;
  pair.fg.src = src;
  pair.bg.load(); pair.fg.load();
  forcePlay(pair.bg);
  forcePlay(pair.fg);
}

function setActive(pair, isActive){
  pair.bg.classList.toggle("active", isActive);
  pair.fg.classList.toggle("active", isActive);
}

function switchVideo(){
  index = (index + 1) % videos.length;
  setPair(idle, videos[index]);

  idle.fg.oncanplay = () => {
    setActive(active, false);
    setActive(idle, true);

    forcePlay(idle.bg);
    forcePlay(idle.fg);

    const temp = active; active = idle; idle = temp;

    idle.bg.pause(); idle.fg.pause();
    idle.bg.currentTime = 0; idle.fg.currentTime = 0;
    idle.fg.oncanplay = null;
  };
}

/* iPhone fix: mostro il primo video SOLO quando Ã¨ pronto */
function startCarousel(){
  document.getElementById("bgCarousel").style.display = "block";
  setPair(active, videos[0]);

  active.fg.oncanplay = () => {
    setActive(active, true);
    forcePlay(active.bg);
    forcePlay(active.fg);
    active.fg.oncanplay = null;

    if(!timer) timer = setInterval(switchVideo, SWITCH_EVERY_MS);
  };

  setTimeout(() => {
    if(!active.fg.classList.contains("active")){
      setActive(active, true);
      forcePlay(active.bg);
      forcePlay(active.fg);
      if(!timer) timer = setInterval(switchVideo, SWITCH_EVERY_MS);
    }
  }, 1200);
}

/* ====== NO: cambia testo + SI cresce ====== */
let messageIndex = 0;
let scaleSize = 1;

const messages = [
  "SEI SICURA? ðŸ˜",
  "DAVVERO VUOI DIRE DI NO? ðŸ˜Œ",
  "NON PUOI RESISTERMI ðŸ’‹",
  "ULTIMA POSSIBILITÃ€... ðŸ˜ˆ",
  "LO SAPPIAMO ENTRAMBI ðŸ’•"
];

function handleNoClick(){
  const noButton = document.querySelector(".no-button");
  const yesButton = document.querySelector(".yes-button");

  noButton.textContent = messages[messageIndex];
  messageIndex = (messageIndex + 1) % messages.length;

  scaleSize += 0.18;
  const s = Math.min(scaleSize, 2.6);
  yesButton.style.transform = `scale(${s})`;
  yesButton.style.boxShadow = `0 0 ${24*s}px rgba(255,0,85,0.85)`;
}

/* ====== YES CLICK ====== */
function handleYesClick(){
  document.body.style.background = "#000";

  startCarousel();

  document.getElementById("main").style.display = "none";
  document.getElementById("finalMessage").style.display = "flex";

  const music = document.getElementById("bgMusic");
  music.currentTime = MUSIC_START_AT;
  music.volume = 0.6;
  music.play().catch(()=>{});

  for(let i=0;i<55;i++){
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.textContent = "â¤";
    heart.style.left = (Math.random()*100) + "vw";
    heart.style.animationDuration = (Math.random()*4 + 3) + "s";
    heart.style.fontSize = (Math.random()*18 + 20) + "px";
    heart.style.opacity = (Math.random()*0.5 + 0.5);
    document.body.appendChild(heart);
    setTimeout(()=>heart.remove(), 12000);
  }

  document.body.addEventListener("touchend", () => {
    forcePlay(active.bg);
    forcePlay(active.fg);
  }, { once:true });
}
</script>

</body>
</html>