<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Solo per Daria</title>

<style>
:root{
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
  --safe-right: env(safe-area-inset-right);
}

*{ box-sizing:border-box; }

html, body { height:100%; }

body{
  margin:0;
  overflow:hidden;
  position:relative;
  color:#fff;

  /* Font super leggibile */
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text",
               "Segoe UI", Roboto, Arial, sans-serif;

  /* Se vuoi usare l'immagine iniziale prima del click */
  background: url("sfondo.jpg") center/cover no-repeat;
  background-color:#000;
}

/* Overlay leggero per leggibilit√† testo (senza box) */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background: rgba(0,0,0,0.18); /* basso: video visibili */
  z-index:1;
}

/* VIDEO CAROUSEL */
.bg-carousel{
  position:fixed;
  inset:0;
  z-index:0;
  display:none;
  background:#000;
}
.bg-carousel .layer{
  position:absolute;
  inset:0;
}

/* Sfondo blur (riempie schermo) */
.bg-carousel video.bg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  filter: blur(18px) brightness(0.78);
  transform: scale(1.08);
  opacity:0;
  transition: opacity 1.2s ease;
}

/* Foreground: mostra tutto (NO TAGLIO) */
.bg-carousel video.fg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:contain;
  opacity:0;
  transition: opacity 1.2s ease;
}

.bg-carousel video.active{
  opacity:1;
}

/* CONTENUTI */
.screen{
  position:relative;
  z-index:2;
  min-height: 100dvh;
  min-height: 100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  padding:
    calc(22px + var(--safe-top))
    calc(18px + var(--safe-right))
    calc(22px + var(--safe-bottom))
    calc(18px + var(--safe-left));
  gap:16px;
  text-align:center;
}

/* Testo in CAPS con bordo nero */
.title{
  margin:0;
  width:min(92vw, 760px);
  font-weight: 900;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-size: clamp(22px, 5.6vw, 40px);
  line-height: 1.15;

  /* Bordo nero (webkit stroke) + ombra per compatibilit√† */
  -webkit-text-stroke: 2px rgba(0,0,0,0.85);
  text-shadow:
    0 2px 0 rgba(0,0,0,0.85),
    0 6px 18px rgba(0,0,0,0.55);
}

/* Bottoni touch-friendly */
.buttons{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  justify-content:center;
}

button{
  padding:14px 22px;
  font-size:18px;
  border:none;
  border-radius:999px;
  cursor:pointer;
  min-width:120px;
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.06em;
}

.yes-button{
  background:#ff0055;
  color:white;
  box-shadow:0 0 22px rgba(255,0,85,.65);
}

.no-button{
  background:rgba(255,255,255,.14);
  color:white;
  border:1px solid rgba(255,255,255,.18);
}

/* Messaggio finale: senza box, solo testo centrato */
#finalMessage{
  display:none;
}

.finalText{
  width:min(92vw, 760px);
  font-size: clamp(18px, 4.6vw, 28px);
  line-height: 1.65;
  font-weight: 800;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  text-align:center;

  -webkit-text-stroke: 1.6px rgba(0,0,0,0.85);
  text-shadow:
    0 2px 0 rgba(0,0,0,0.85),
    0 10px 22px rgba(0,0,0,0.55);

  animation: fadeIn 1.2s ease forwards;
  opacity:0;
}

@keyframes fadeIn{
  from{opacity:0; transform: translateY(10px);}
  to{opacity:1; transform: translateY(0);}
}

/* Cuori */
.heart{
  position:fixed;
  top:-12vh;
  z-index:3;
  pointer-events:none;
  will-change: transform;
  color:#ff4d88;
  text-shadow: 0 6px 18px rgba(0,0,0,.35);
  animation: fall linear infinite;
}

@keyframes fall{
  0%{ transform: translateY(-10vh); }
  100%{ transform: translateY(120vh); }
}
</style>
</head>

<body>

<!-- VIDEO CAROUSEL -->
<div class="bg-carousel" id="bgCarousel">
  <div class="layer" id="layerA">
    <video id="bgA" class="bg" muted loop playsinline preload="auto"></video>
    <video id="fgA" class="fg" muted loop playsinline preload="auto"></video>
  </div>
  <div class="layer" id="layerB">
    <video id="bgB" class="bg" muted loop playsinline preload="auto"></video>
    <video id="fgB" class="fg" muted loop playsinline preload="auto"></video>
  </div>
</div>

<!-- SCHERMATA INIZIALE -->
<div class="screen" id="main">
  <h2 class="title">POSSO AVERE IL PRIVILEGIO DI CHIAMARTI AMORE MIO? ü•∫üíû</h2>
  <div class="buttons">
    <button class="yes-button" onclick="handleYesClick()">S√å</button>
    <button class="no-button" onclick="handleNoClick()">NO</button>
  </div>
</div>

<!-- MESSAGGIO FINALE -->
<div class="screen" id="finalMessage">
  <div class="finalText">
    ‚ú® DARIA‚Ä¶<br><br>
    PER ME SEI SPECIALE.<br>
    IL TUO NOME NON √à SOLO UN SUONO‚Ä¶<br>
    √à QUALCOSA CHE SENTO DENTRO. üíò<br><br>
    √à CASA. √à BATTITO. √à LUCE.<br><br>
    MI FAI EMOZIONARE.<br>
    MI REGALI SORRISI IMPROVVISI<br>
    E UN AMORE CHE CRESCE OGNI GIORNO. ‚ù§Ô∏è<br><br>
    PERCH√â SCEGLIERTI‚Ä¶<br>
    √à LA COSA PI√ô BELLA CHE POTESSI FARE.<br><br>
    E QUESTO, DARIA‚Ä¶<br>
    √à LA COSA PI√ô NATURALE PER ME. üî•
  </div>
</div>

<!-- MUSICA -->
<audio id="bgMusic" preload="auto" loop>
  <source src="musica.mp3" type="audio/mpeg">
</audio>

<script>
/* ====== VIDEO CAROUSEL (NO TAGLIO) + BLUR BG ====== */
const videos = ["video1.mp4","video2.mp4","video3.mp4","video4.mp4"];

const bgA = document.getElementById("bgA");
const fgA = document.getElementById("fgA");
const bgB = document.getElementById("bgB");
const fgB = document.getElementById("fgB");

let active = { bg: bgA, fg: fgA };
let idle   = { bg: bgB, fg: fgB };
let index = 0;
let timer = null;

function setPair(pair, src){
  pair.bg.src = src;
  pair.fg.src = src;
  pair.bg.load(); pair.fg.load();

  // iPhone: play solo dopo interazione -> qui parte dopo il tap su "S√å"
  pair.bg.play().catch(()=>{});
  pair.fg.play().catch(()=>{});
}

function setActive(pair, isActive){
  pair.bg.classList.toggle("active", isActive);
  pair.fg.classList.toggle("active", isActive);
}

function switchVideo(){
  index = (index + 1) % videos.length;
  setPair(idle, videos[index]);

  idle.fg.oncanplay = () => {
    setActive(active, false);
    setActive(idle, true);

    // swap
    const temp = active; active = idle; idle = temp;

    // reset idle
    idle.bg.pause(); idle.fg.pause();
    idle.bg.currentTime = 0; idle.fg.currentTime = 0;
    idle.fg.oncanplay = null;
  };
}

function startCarousel(){
  document.getElementById("bgCarousel").style.display = "block";
  setPair(active, videos[0]);
  setActive(active, true);

  if(!timer) timer = setInterval(switchVideo, 10000);
}

/* ====== NO BUTTON TEASE ====== */
let messageIndex = 0;
const messages = [
  "SEI SICURA? üòè",
  "DAVVERO VUOI DIRE DI NO? üòå",
  "NON PUOI RESISTERMI üíã",
  "ULTIMA POSSIBILIT√Ä... üòà",
  "LO SAPPIAMO ENTRAMBI üíï"
];

function handleNoClick(){
  const noButton = document.querySelector(".no-button");
  const yesButton = document.querySelector(".yes-button");

  noButton.textContent = messages[messageIndex];
  messageIndex = (messageIndex + 1) % messages.length;

  const current = parseFloat(getComputedStyle(yesButton).fontSize);
  yesButton.style.fontSize = Math.min(current * 1.16, 34) + "px";
}

/* ====== YES CLICK ====== */
function handleYesClick(){
  // Background nero (toglie la foto iniziale)
  document.body.style.background = "#000";

  // Video carousel
  startCarousel();

  // Schermate
  document.getElementById("main").style.display = "none";
  document.getElementById("finalMessage").style.display = "flex";

  // Musica (parte dopo tap -> OK su iPhone)
  const music = document.getElementById("bgMusic");
  music.currentTime = 44;
  music.volume = 0.6;
  music.play().catch(()=>{});

  // Cuori (leggeri + pulizia)
  for(let i=0;i<55;i++){
    const heart = document.createElement("div");
    heart.className="heart";
    heart.textContent="‚ù§";
    heart.style.left = (Math.random()*100) + "vw";
    heart.style.animationDuration = (Math.random()*4+3) + "s";
    heart.style.fontSize = (Math.random()*18+20) + "px";
    heart.style.opacity = (Math.random()*0.5+0.5);
    document.body.appendChild(heart);
    setTimeout(()=>heart.remove(), 12000);
  }
}
</script>

</body>
</html>
